<turbo-frame id="modal-links-repairing-new" target="_top">
    <div class="section">
        <div class="section__title">
            <h1 id="modal-title"><?= _('Repairing a link') ?></h1>
        </div>

        <p class="section__intro">
            <?= _('You can change the <abbr>URL</abbr> of a link if it’s broken, or if you made a mistake in it.') ?>
        </p>

        <form method="post" action="<?= url('repair link', ['id' => $link->id]) ?>">
            <?= $this->include('alerts/_error.phtml', ['message' => $error]) ?>

            <input type="hidden" name="csrf" value="<?= $csrf_token ?>" />
            <input type="hidden" name="from" value="<?= $from ?>" />

            <div
                class="form-group <?= isset($errors['url']) ? 'form-group--invalid' : '' ?>"
                data-controller="link-suggestion"
                data-link-suggestion-url-value="<?= $this->safe('url_cleared') ?>"
            >
                <label for="url">
                    <?= _('What’s the address of the link?') ?>
                </label>

                <input
                    id="url"
                    name="url"
                    type="url"
                    placeholder="https://…"
                    required
                    value="<?= $url ?>"
                    autocomplete="off"
                    autofocus
                    aria-describedby="url-desc"
                    data-link-suggestion-target="input"
                />

                <div id="url-desc">
                    <?php if (isset($errors['url'])): ?>
                        <p class="form-group__error">
                            <span class="sr-only"><?= _('Error') ?></span>
                            <?= $errors['url'] ?>
                        </p>
                    <?php endif; ?>

                    <?php if ($url !== $url_cleared): ?>
                        <p class="form-group__error" data-link-suggestion-target="message">
                            <?php if ($url_cleared): ?>
                                <?= _f('%s has detected trackers in this <abbr>URL</abbr>. Suggestion:', $brand) ?>
                                <?= $url_cleared ?>

                                <button
                                    type="button"
                                    class="button--small"
                                    data-action="link-suggestion#change"
                                >
                                    <?= _('Ok') ?>
                                </button>
                            <?php else: ?>
                                <?= _f('%s has detected that this <abbr>URL</abbr> tracks users. It is suggested to delete the link.', $brand) ?>
                            <?php endif; ?>
                        </p>
                    <?php endif; ?>
                </div>
            </div>

            <div class="form-group">
                <input
                    type="checkbox"
                    id="ask-sync"
                    name="ask_sync"
                    <?= $ask_sync ? 'checked' : '' ?>
                    aria-describedby="ask-sync-caption"
                />

                <label class="label--checkbox" for="ask-sync">
                    <?= _('Ask for a new synchronization') ?>
                </label>

                <p class="form-group__caption" id="ask-sync-caption">
                    <?= _('This will check the status of the page and possibly update the illustration.') ?>
                </p>
            </div>

            <div class="form__actions">
                <button type="submit" class="button--primary">
                    <?= _('Repair the link') ?>
                </button>
            </div>
        </form>
    </div>
</turbo-frame>
